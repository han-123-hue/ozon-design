<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Custom Master</title>
    <style>
        :root { --main-blue: #005bff; --bg-dark: #121212; }
        body { font-family: -apple-system, sans-serif; margin: 0; background: var(--bg-dark); color: white; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        /* 1. éªŒè¯é®ç½©å±‚ (æ¨¡æ‹Ÿå½¢ç™½è®¢å•éªŒè¯) */
        #auth-overlay { position: fixed; inset: 0; background: var(--bg-dark); z-index: 2000; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        .input-box { background: #222; border: 1px solid #444; color: white; padding: 15px; width: 80%; border-radius: 10px; text-align: center; margin-bottom: 20px; outline: none; }
        .btn-verify { background: var(--main-blue); color: white; padding: 15px 40px; border-radius: 30px; font-weight: bold; cursor: pointer; }

        /* 2. ä¸»ç”»å¸ƒåŒº */
        .canvas-area { flex: 1; display: flex; align-items: center; justify-content: center; position: relative; }
        #capture-box { width: 320px; height: 320px; background: white; border-radius: 12px; overflow: hidden; position: relative; box-shadow: 0 0 50px rgba(0,0,0,0.5); }
        #bg-tpl { width: 100%; height: 100%; object-fit: cover; }
        #user-img { position: absolute; width: 150px; top: 50px; left: 80px; touch-action: none; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.4)); display: none; }

        /* 3. åº•éƒ¨æ¨¡ç‰ˆåº“ (å½¢ç™½åŒæ¬¾æ»šåŠ¨æ¡) */
        .tpl-scroll { height: 90px; background: #1e1e1e; display: flex; align-items: center; overflow-x: auto; padding: 0 15px; gap: 12px; }
        .tpl-item { width: 60px; height: 60px; border-radius: 8px; flex-shrink: 0; border: 2px solid transparent; overflow: hidden; opacity: 0.6; transition: 0.3s; }
        .tpl-item.active { border-color: var(--main-blue); opacity: 1; transform: scale(1.1); }
        .tpl-item img { width: 100%; height: 100%; object-fit: cover; }

        /* 4. æ“ä½œåŒº */
        .panel { background: #1e1e1e; padding: 20px; border-top: 1px solid #333; }
        .btn-up { background: var(--main-blue); color: white; padding: 16px; border-radius: 12px; text-align: center; font-weight: bold; position: relative; cursor: pointer; }
        #loading { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 1000; flex-direction: column; align-items: center; justify-content: center; }
    </style>
</head>
<body>

<div id="auth-overlay">
    <h3 style="margin-bottom: 30px;">Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ·Ğ°ĞºĞ°Ğ·Ğ°<br>(è¯·è¾“å…¥è®¢å•å·)</h3>
    <input type="text" id="order-id" class="input-box" placeholder="Order ID / æš—å·">
    <div class="btn-verify" onclick="verifyOrder()">Ğ’ĞĞ™Ğ¢Ğ˜ (è¿›å…¥)</div>
    <p style="font-size: 11px; color: #666; margin-top: 20px;">Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ Ğ¿Ğ¾ĞºÑƒĞ¿Ğ°Ñ‚ĞµĞ»ĞµĞ¹ Ozon</p>
</div>

<div class="canvas-area">
    <div id="capture-box">
        <img id="bg-tpl" src="https://img.alicdn.com/imgextra/i4/2210667046465/O1CN01Zp1X1X1X1X1X1X1X1X_!!2210667046465.jpg">
        <img id="user-img">
    </div>
</div>

<div class="tpl-scroll" id="tpl-list">
    <div class="tpl-item active" onclick="changeBg('https://img.alicdn.com/imgextra/i4/2210667046465/O1CN01Zp1X1X1X1X1X1X1X1X_!!2210667046465.jpg', this)"><img src="https://img.alicdn.com/imgextra/i4/2210667046465/O1CN01Zp1X1X1X1X1X1X1X1X_!!2210667046465.jpg"></div>
    <div class="tpl-item" onclick="changeBg('https://img.alicdn.com/imgextra/i2/2210667046465/O1CN016pXv1r1X1X1X1X1X1X_!!2210667046465.jpg', this)"><img src="https://img.alicdn.com/imgextra/i2/2210667046465/O1CN016pXv1r1X1X1X1X1X1X_!!2210667046465.jpg"></div>
    <div class="tpl-item" onclick="changeBg('https://img.alicdn.com/imgextra/i3/2210667046465/O1CN01pXv1r1X1X1X1X1X1X1X_!!2210667046465.jpg', this)"><img src="https://img.alicdn.com/imgextra/i3/2210667046465/O1CN01pXv1r1X1X1X1X1X1X1X_!!2210667046465.jpg"></div>
</div>

<div class="panel">
    <div class="btn-up">
        ğŸ“¸ Ğ—ĞĞ“Ğ Ğ£Ğ—Ğ˜Ğ¢Ğ¬ Ğ¤ĞĞ¢Ğ (ä¸Šä¼ ç…§ç‰‡)
        <input type="file" id="up-file" accept="image/*" style="position:absolute; inset:0; opacity:0; cursor:pointer;">
    </div>
    <p style="text-align:center; font-size:11px; color:#666; margin-top:10px;">Ğ”Ğ²Ğ¸Ğ³Ğ°Ğ¹Ñ‚Ğµ Ğ¸ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ Ğ´Ğ²ÑƒĞ¼Ñ Ğ¿Ğ°Ğ»ÑŒÑ†Ğ°Ğ¼Ğ¸</p>
</div>

<div id="loading">ğŸš€ ĞĞ‘Ğ ĞĞ‘ĞĞ¢ĞšĞ...</div>

<script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
<script>
    const API_KEY = 'd12kqQkrNx9hZgF6ZRU8MSmA'; 

    // 1. ç®€æ˜“éªŒè¯åŠŸèƒ½
    function verifyOrder() {
        const val = document.getElementById('order-id').value;
        if(val.length > 3) { // åªè¦é•¿åº¦å¤§äº3å°±è®©è¿›ï¼Œä½ å¯ä»¥æ”¹æˆç‰¹å®šæš—å·
            document.getElementById('auth-overlay').style.display = 'none';
        } else {
            alert('ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ´ (è®¢å•å·æ— æ•ˆ)');
        }
    }

    // 2. æ¨¡ç‰ˆåˆ‡æ¢
    function changeBg(url, el) {
        document.getElementById('bg-tpl').src = url;
        document.querySelectorAll('.tpl-item').forEach(i => i.classList.remove('active'));
        el.classList.add('active');
    }

    // 3. AI æŠ å›¾
    document.getElementById('up-file').onchange = async (e) => {
        const file = e.target.files[0];
        if(!file) return;
        document.getElementById('loading').style.display = 'flex';
        
        const fd = new FormData();
        fd.append('image_file', file);
        
        try {
            const res = await fetch('https://api.remove.bg/v1.0/removebg', {
                method: 'POST',
                headers: {'X-Api-Key': API_KEY},
                body: fd
            });
            if(res.ok) {
                const blob = await res.blob();
                const img = document.getElementById('user-img');
                img.src = URL.createObjectURL(blob);
                img.style.display = 'block';
            }
        } finally {
            document.getElementById('loading').style.display = 'none';
        }
    };

    // 4. æ‰‹åŠ¿ç¼©æ”¾æ—‹è½¬åŠŸèƒ½ (ä¸å½¢ç™½ä½“éªŒä¸€è‡´)
    let angle = 0, scale = 1;
    interact('#user-img').gesturable({
        onmove: (ev) => {
            scale *= (1 + ev.ds);
            angle += ev.da;
            ev.target.style.transform = `scale(${scale}) rotate(${angle}deg)`;
        }
    }).draggable({
        onmove: (ev) => {
            const x = (parseFloat(ev.target.dataset.x) || 0) + ev.dx;
            const y = (parseFloat(ev.target.dataset.y) || 0) + ev.dy;
            ev.target.style.left = `${80 + x}px`;
            ev.target.style.top = `${50 + y}px`;
            ev.target.dataset.x = x;
            ev.target.dataset.y = y;
        }
    });
</script>
</body>
</html>
