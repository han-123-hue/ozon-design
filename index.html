<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Magnet Designer Pro</title>
    <style>
        :root { --ozon-blue: #005bff; --action-pink: #f91155; }
        body { font-family: -apple-system, sans-serif; margin: 0; background: #121212; color: white; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        /* é¡¶éƒ¨è£…é¥° */
        .header { background: #1e1e1e; padding: 15px; text-align: center; font-size: 14px; border-bottom: 1px solid #333; color: #aaa; }

        /* ç”»å¸ƒåŒº - æ¨¡ä»¿ä¸“ä¸šä½œå›¾è½¯ä»¶ */
        .canvas-container { flex: 1; display: flex; align-items: center; justify-content: center; position: relative; padding: 10px; }
        #magnet-canvas { width: 340px; height: 340px; background: #fff; border-radius: 15px; position: relative; overflow: hidden; box-shadow: 0 0 40px rgba(0,0,0,0.8); }
        
        /* æ¨¡ç‰ˆå±‚ (åœ¨ä¸Š) */
        #tpl-img { width: 100%; height: 100%; position: absolute; top: 0; left: 0; z-index: 10; pointer-events: none; }
        
        /* ç”¨æˆ·ç…§ç‰‡å±‚ (åœ¨ä¸‹) */
        #user-img { position: absolute; top: 50px; left: 80px; width: 160px; z-index: 5; touch-action: none; display: none; filter: drop-shadow(0 0 10px rgba(0,0,0,0.2)); }

        /* åº•éƒ¨æ¨¡ç‰ˆæ»‘åŠ¨æ  */
        .tpl-selector { height: 100px; background: #1e1e1e; display: flex; align-items: center; overflow-x: auto; padding: 0 15px; gap: 12px; border-top: 1px solid #333; }
        .tpl-thumb { width: 65px; height: 65px; border-radius: 10px; border: 2px solid transparent; flex-shrink: 0; overflow: hidden; transition: 0.2s; opacity: 0.6; }
        .tpl-thumb.active { border-color: var(--ozon-blue); opacity: 1; transform: scale(1.1); }
        .tpl-thumb img { width: 100%; height: 100%; object-fit: cover; }

        /* æ§åˆ¶å° */
        .footer { padding: 20px; background: #1e1e1e; display: flex; flex-direction: column; gap: 10px; }
        .btn { padding: 16px; border-radius: 12px; text-align: center; font-weight: bold; cursor: pointer; text-decoration: none; }
        .btn-blue { background: var(--ozon-blue); color: white; }
        .btn-pink { background: var(--action-pink); color: white; display: none; }
        
        #loading { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 1000; flex-direction: column; align-items: center; justify-content: center; }
    </style>
</head>
<body>

<div class="header">Ğ¡ĞĞœ Ğ¡Ğ•Ğ‘Ğ• Ğ”Ğ˜Ğ—ĞĞ™ĞĞ•Ğ  â€¢ AI MAGNET</div>

<div class="canvas-container">
    <div id="magnet-canvas">
        <img id="tpl-img" src="https://img.alicdn.com/imgextra/i4/2210667046465/O1CN01Zp1X1X1X1X1X1X1X1X_!!2210667046465.jpg">
        <img id="user-img">
    </div>
</div>

<div class="tpl-selector">
    <div class="tpl-thumb active" onclick="setTpl('https://img.alicdn.com/imgextra/i4/2210667046465/O1CN01Zp1X1X1X1X1X1X1X1X_!!2210667046465.jpg', this)">
        <img src="https://img.alicdn.com/imgextra/i4/2210667046465/O1CN01Zp1X1X1X1X1X1X1X1X_!!2210667046465.jpg">
    </div>
    <div class="tpl-thumb" onclick="setTpl('https://img.alicdn.com/imgextra/i2/2210667046465/O1CN016pXv1r1X1X1X1X1X1X_!!2210667046465.jpg', this)">
        <img src="https://img.alicdn.com/imgextra/i2/2210667046465/O1CN016pXv1r1X1X1X1X1X1X_!!2210667046465.jpg">
    </div>
</div>

<div class="footer">
    <label class="btn btn-blue">
        ğŸ“¸ Ğ—ĞĞ“Ğ Ğ£Ğ—Ğ˜Ğ¢Ğ¬ Ğ¤ĞĞ¢Ğ (ä¸Šä¼ ç…§ç‰‡)
        <input type="file" id="file-input" accept="image/*" style="display:none">
    </label>
    <div id="save-btn" class="btn btn-pink" onclick="alert('Ğ¡Ğ´ĞµĞ»Ğ°Ğ¹Ñ‚Ğµ ÑĞºÑ€Ğ¸Ğ½ÑˆĞ¾Ñ‚ Ğ¸ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ Ğ½Ğ°Ğ¼! (è¯·æˆªå›¾å‘é€ç»™å®¢æœ)')">âœ… Ğ“ĞĞ¢ĞĞ’Ğ (å®Œæˆè®¾è®¡)</div>
    <p style="font-size: 11px; color: #666; text-align: center;">Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ Ğ´Ğ²Ğ° Ğ¿Ğ°Ğ»ÑŒÑ†Ğ° Ğ´Ğ»Ñ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ<br>(åŒæŒ‡æåˆç¼©æ”¾/æ—‹è½¬ç…§ç‰‡)</p>
</div>

<div id="loading">ğŸš€ AI ĞšĞ Ğ•ĞœĞ›Ğ˜...</div>

<script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
<script>
    // â¬‡ï¸ æ©äººï¼Œè¿™é‡Œè¿˜æ˜¯å¡«ä½ çš„å¯†é’¥ï¼
    const API_KEY = 'd12kqQkrNx9hZgF6ZRU8MSmA'; 

    function setTpl(url, el) {
        document.getElementById('tpl-img').src = url;
        document.querySelectorAll('.tpl-thumb').forEach(t => t.classList.remove('active'));
        el.classList.add('active');
    }

    document.getElementById('file-input').onchange = async (e) => {
        const file = e.target.files[0];
        if(!file) return;
        document.getElementById('loading').style.display = 'flex';
        const fd = new FormData();
        fd.append('image_file', file);
        try {
            const res = await fetch('https://api.remove.bg/v1.0/removebg', {
                method: 'POST',
                headers: {'X-Api-Key': API_KEY},
                body: fd
            });
            if(res.ok) {
                const blob = await res.blob();
                const img = document.getElementById('user-img');
                img.src = URL.createObjectURL(blob);
                img.style.display = 'block';
                document.getElementById('save-btn').style.display = 'block';
            }
        } finally {
            document.getElementById('loading').style.display = 'none';
        }
    };

    // æ ¸å¿ƒä½œå›¾åŠŸèƒ½ï¼šåŒæŒ‡æåˆç¼©æ”¾ã€æ—‹è½¬ã€ç§»åŠ¨
    let angle = 0, scale = 1;
    interact('#user-img').gesturable({
        onmove: (ev) => {
            scale *= (1 + ev.ds);
            angle += ev.da;
            ev.target.style.transform = `scale(${scale}) rotate(${angle}deg)`;
        }
    }).draggable({
        onmove: (ev) => {
            const x = (parseFloat(ev.target.dataset.x) || 0) + ev.dx;
            const y = (parseFloat(ev.target.dataset.y) || 0) + ev.dy;
            ev.target.style.left = `${80 + x}px`;
            ev.target.style.top = `${50 + y}px`;
            ev.target.dataset.x = x;
            ev.target.dataset.y = y;
        }
    });
</script>
</body>
</html>
